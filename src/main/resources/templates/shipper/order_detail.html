<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head}">
    <title>CHI TIẾT ĐƠN HÀNG - Badminton Shop</title>
</head>
<body>
<div th:replace="~{fragments/header-shipper :: header-shipper}"></div>

<div class="container mt-4">
    <a th:href="@{/shipper/dashboard}" class="btn btn-outline-primary mb-3">
        <i class="fas fa-arrow-left"></i> Quay lại Dashboard
    </a>

    <div class="card shadow">
        <div class="card-header bg-warning text-dark">
            <h4><i class="fas fa-box"></i> Chi tiết đơn hàng - Chờ nhận</h4>
        </div>
        <div class="card-body">
            <h5 class="mb-3 text-primary">Thông tin đơn hàng</h5>
            <table class="table table-bordered">
                <tr><th>Mã đơn hàng</th><td th:text="${order.id}"></td></tr>

                <tr>
                    <th>Trạng thái</th>
                    <td>
                        <span class="badge bg-warning text-dark">
                            <i class="fas fa-clock"></i> Chờ shipper nhận
                        </span>
                    </td>
                </tr>

                <tr><th>Phí vận chuyển</th>
                    <td th:text="${#numbers.formatDecimal(order.shippingFee,0,'POINT',0,'COMMA')} + ' ₫'"></td>
                </tr>

                <tr><th>Giá trị đơn hàng (COD)</th>
                    <td class="fw-bold text-danger" th:text="${#numbers.formatDecimal(order.amountFromUser,0,'POINT',0,'COMMA')} + ' ₫'"></td>
                </tr>

                <tr>
                    <th>Thời gian tạo đơn</th>
                    <td th:text="${#temporals.format(order.createdAt, 'HH:mm dd/MM/yyyy')}"></td>
                </tr>
                
                <tr th:if="${order.isPaidBefore}">
                    <th>Thanh toán</th>
                    <td><span class="badge bg-success">Đã thanh toán trước</span></td>
                </tr>
            </table>

            <h5 class="mt-4 mb-3 text-success">Thông tin khách hàng</h5>
            <table class="table table-bordered">
                <tr><th>Tên khách hàng</th><td th:text="${order.user.fullName}"></td></tr>
                <tr><th>Số điện thoại</th><td th:text="${order.phone}"></td></tr>
                <tr><th>Địa chỉ giao hàng</th><td th:text="${order.address}"></td></tr>
            </table>

            <h5 class="mt-4 mb-3 text-info">Danh sách sản phẩm</h5>
            <table class="table table-striped table-hover align-middle">
                <thead class="table-light">
                <tr><th>Tên sản phẩm</th><th>Số lượng</th><th>Giá</th><th>Tổng cộng</th></tr>
                </thead>
                <tbody>
                <tr th:each="item : ${orderItems}">
                    <td th:text="${item.product.name}"></td>
                    <td th:text="${item.quantity}"></td>
                    <td th:text="${#numbers.formatDecimal(order.amountFromUser,0,'POINT',0,'COMMA')} + ' ₫'"></td>
                    <td class="fw-bold text-danger"
                        th:text="${#numbers.formatDecimal((order.amountFromUser ?: 0) + (order.shippingFee ?: 0), 0, 'COMMA', 0, 'POINT')} + ' ₫'">
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(orderItems)}">
                    <td colspan="4" class="text-center text-muted">Không có sản phẩm nào</td>
                </tr>
                </tbody>
            </table>

            <div class="mt-4 text-end">
                <a th:href="@{/shipper/dashboard}" class="btn btn-secondary me-2">
                    <i class="fas fa-arrow-left"></i> Quay lại
                </a>
                <form th:action="@{'/shipper/accept/' + ${order.id}}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-warning btn-lg">
                        <i class="fas fa-handshake"></i> Nhận đơn này
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<div th:replace="~{fragments/footer-shipper :: footer-shipper}"></div>
</body>
</html>
